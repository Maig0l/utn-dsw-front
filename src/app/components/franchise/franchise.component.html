<!-- GET ALL -->
<section>
  <h1>Listing franchises</h1>

  <button (click)="showFranchises()">Get Franchises</button>

  @for (franchise of franchises; track franchise.id) {
    <div class="franchise-item">
      <small>[{{ franchise.id }}]</small>&nbsp;
      <b>{{ franchise.name }}</b> &nbsp;
    </div>
  }
</section>

<!-- CREATE -->
<section>
  <h1>Create new franchise</h1>
  <form [formGroup]="franchiseForm" (submit)="addFranchise()">
    <label for="name">Name</label>
    <input type="text" id="name" formControlName="name" />

    <label for="img">Games</label>
    <mat-chip-grid #chipGrid aria-label="Enter games">
      @for (game of gameSelected; track game) {
        <mat-chip (removed)="remove(game)">
          <!--img
            class="chip-portrait"
            [src]="game.portrait"
            alt="{{ game.title }}"
          /-->
          {{ game.title }}
          <button matChipRemove [attr.aria-label]="'remove ' + game.title">
            <mat-icon>cancel</mat-icon>
          </button>
        </mat-chip>
      }
    </mat-chip-grid>
    <mat-form-field class="example-full-width">
      <input
        class="custom-input"
        type="text"
        placeholder="Search games..."
        aria-label="Game"
        matInput
        [formControl]="myControl"
        [matAutocomplete]="auto"
      />
      <mat-autocomplete #auto="matAutocomplete">
        @for (option of filteredOptions | async; track option) {
          <mat-option [value]="" (click)="addGame(option)">
            <!--img
              class="option-portrait"
              [src]="option.portrait"
              alt="{{ option.title }}"
            /-->
            <span class="option-title">{{ option.title }}</span>
          </mat-option>
        }
      </mat-autocomplete>
    </mat-form-field>

    <button type="submit" class="primary">Create</button>
  </form>
</section>

<!-- UPDATE -->
<section class="column">
  <h1>Enter Franchise ID to Edit</h1>
  <form [formGroup]="franchiseIdForm">
    <div>
      <label for="franchiseId">Franchise ID:</label>
      <input id="franchiseId" formControlName="id" />
    </div>
    <button type="button" (click)="populateForm()">Fetch Franchise</button>
  </form>

  <div *ngIf="editReady">
    <h1>Edit Franchise</h1>
    <form [formGroup]="updateForm" (submit)="updateFranchise()">
      <div>
        <label for="name">Name:</label>
        <input id="name" formControlName="name" />
      </div>
      <mat-chip-grid #chipGrid aria-label="Enter games">
        @for (game of gameSelected; track game) {
          <mat-chip (removed)="remove(game)">
            <!--img
              class="chip-portrait"
              [src]="game.portrait"
              alt="{{ game.title }}"
            /-->
            {{ game.title }}
            <button matChipRemove [attr.aria-label]="'remove ' + game.title">
              <mat-icon>cancel</mat-icon>
            </button>
          </mat-chip>
        }
      </mat-chip-grid>
      <mat-form-field class="example-full-width">
        <input
          class="custom-input"
          type="text"
          placeholder="Search games..."
          aria-label="Game"
          matInput
          [formControl]="myControl"
          [matAutocomplete]="auto"
        />
        <mat-autocomplete #auto="matAutocomplete">
          @for (option of filteredOptions | async; track option) {
            <mat-option [value]="" (click)="addGame(option)">
              <!--img
                class="option-portrait"
                [src]="option.portrait"
                alt="{{ option.title }}"
              /-->
              <span class="option-title">{{ option.title }}</span>
            </mat-option>
          }
        </mat-autocomplete>
      </mat-form-field>
      <button type="submit" class="primary">Update</button>
    </form>
  </div>
</section>

<section>
  <h1>Delete a franchise</h1>
  <form [formGroup]="deleteForm" (submit)="deleteFranchise()">
    <input type="number" formControlName="id" />
    <input type="submit" />
  </form>
</section>
